{% extends "website/base.html" %}

{% load static %}
{% load consupedia %}

{% block title %}Products {{ block.super }}{% endblock %}

{% block content %}


  <h3 class="view-title">Products</h3>

{% if user.is_authenticated %}
  <section class="csp-menu">
    <a class="button primary" href="{% url 'product-add' %}">Nieuw</a>
  </section>
{% endif %}

<form type="get" action="." style="margin: 0">
    <input  id="search_box" type="text" name="search_box"  placeholder="Search..." >
    <button id="search_submit" type="submit" >Submit</button>
</form>

<section class="grid">

  {% for product in products %}

    <div class="csp-product csp-card">
        <h4><a href="{% url 'product' product.id %}">{{ product.name }}</a></h4>
        <p>{{ product.price }} cent</p>
		{% if product.category %}
		<p>Category: <a href="{% url 'category' product.category.id %}">{{ product.category.name }}</a></p>
		{% else %}
		<p>Category: {{ product.category.name }}</p>
		{% endif %}
		{% get_product_rating product user as user_rating %}
		<section class="csp-rater" data-global-rating="4.3" data-user-rating="{{ user_rating }}" data-product-id="{{ product.id }}">
			<div class="csp-global-rating">
			<i class="glyphicon glyphicon-star"></i><i class="glyphicon glyphicon-star"></i><i class="glyphicon glyphicon-star"></i><i class="glyphicon glyphicon-star"></i><i class="glyphicon glyphicon-star"></i>
			</div>
			<div class="csp-user-rating">
			<i class="glyphicon glyphicon-star"></i><i class="glyphicon glyphicon-star"></i><i class="glyphicon glyphicon-star"></i><i class="glyphicon glyphicon-star"></i><i class="glyphicon glyphicon-star"></i>
			</div>			
		</section>
{% if user.is_authenticated %}
		<div>
			<a class='csp-edit csp-btn' href="{% url 'product-edit' product.id %}"><i class="glyphicon glyphicon-pencil"></i></a>
		</div>
{% endif %}
    </div>

  {% endfor %}

</section>
<script src="{% static 'js/products.js' %}" type="text/javascript"></script>
{% endblock %}